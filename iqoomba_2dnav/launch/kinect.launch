<launch>


<arg name="config" default="$(find ca_driver)/config/default.yaml" />
<arg name="desc" default="true" />
<node name="ca_driver" pkg="ca_driver" type="ca_driver" output="screen">
	<rosparam command="load" file="$(arg config)" />
	<param name="robot_model" value="CREATE_2" />
</node>
<!-- Robot description -->
<include if="$(arg desc)" file="$(find ca_description)/launch/create_2.launch" />

<include file="$(find kinect2_bridge)/launch/kinect2_bridge.launch">
<arg name="depth_method" default="opengl"/>
<arg name="reg_method" default="cpu"/>
<arg name="publish_tf" default="true"/>
</include>

<node pkg="pointcloud_to_laserscan" type="pointcloud_to_laserscan_node" name="pointcloud_to_laserscan">
<remap from="cloud_in" to="/kinect2/sd/points"/>
<remap from="scan" to="/scan"/>
<rosparam>
target_frame: base_link
transform_tolerance: 0.01
min_height: 0.01
max_height: 0.2
angle_min: -0.3 # -M_PI/2
angle_max:  0.3 # M_PI/2
angle_increment: 0.0087 # M_PI/360.0
scan_time: 0.3333
range_min: 0.04
range_max: 4.0
use_inf: true
inf_epsilon: 1.0
# Concurrency level, affects number of pointclouds queued for processing and number of threads used
# 0 : Detect number of cores
# 1 : Single threaded
# 2->inf : Parallelism level
concurrency_level: 1
</rosparam>
</node>

<node pkg="iqoomba_tf_setup" type="tf_broadcaster.py" name="tf_broadcaster" output="screen"></node>

</launch> 
